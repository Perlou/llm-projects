# 企业文档搜索引擎

## 项目简介

构建企业级文档搜索引擎，支持混合检索（BM25 + 向量）、查询扩展、语义重排序等高级功能，提供精准的全文搜索能力。

## 功能特性

- ✅ 混合检索（BM25 + 向量检索）
- ✅ RRF 结果融合算法
- ✅ 查询扩展和改写
- ✅ Cross-Encoder 语义重排序
- ✅ 多语言支持（中英文）
- ✅ 搜索结果高亮
- ✅ 搜索分析统计

## 快速开始

### 1. 安装依赖

```bash
pip install -r requirements.txt
```

### 2. 配置环境变量

```bash
cp .env.example .env
# 编辑 .env 文件
```

### 3. 添加文档

将文档放入 `docs/` 目录

### 4. 运行搜索引擎

```bash
python main.py
```

## 使用示例

```
🔍 企业文档搜索引擎 v1.0

索引状态: 1,234 个文档 | 5,678 个片段

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

搜索: 如何提高系统性能

[检索统计]
  BM25: 15 条 | 向量: 20 条 | 融合: 25 条 | 重排后: 5 条

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

1. [98.5%] 系统性能优化指南.pdf
   "...通过以下方法可以显著<mark>提高系统性能</mark>：
   1. 使用缓存减少数据库查询
   2. 优化 SQL 语句..."

2. [96.2%] 缓存最佳实践.md
   "缓存是<mark>提升性能</mark>的关键手段，合理使用可以..."

3. [94.1%] 数据库优化手册.pdf
   "数据库<mark>性能</mark>优化需要从索引、查询、架构..."

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
耗时: 0.45s | 查询扩展: "性能优化, 系统调优, 性能提升"
```

## 核心技术

### 混合检索架构

```
用户查询
    │
    ▼
┌───────────┐
│ 查询处理  │ → 查询扩展/改写
└───────────┘
    │
    ▼
┌───────────────────────────┐
│      并行检索              │
│  ┌─────────┐ ┌─────────┐  │
│  │  BM25   │ │  向量   │  │
│  │  检索   │ │  检索   │  │
│  └─────────┘ └─────────┘  │
└───────────────────────────┘
    │
    ▼
┌───────────┐
│ RRF 融合  │ → 结果合并
└───────────┘
    │
    ▼
┌───────────┐
│  Rerank   │ → 语义重排序
└───────────┘
    │
    ▼
┌───────────┐
│ 后处理    │ → 高亮、格式化
└───────────┘
```

### 关键参数

| 参数         | 默认值 | 说明             |
| ------------ | ------ | ---------------- |
| bm25_k       | 20     | BM25 返回数量    |
| vector_k     | 20     | 向量检索返回数量 |
| rrf_k        | 60     | RRF 融合参数     |
| rerank_top_n | 5      | 重排序后返回数量 |

## 技术栈

- Python 3.10+
- LangChain - 检索框架
- ChromaDB - 向量数据库
- rank_bm25 - BM25 实现
- sentence-transformers - Reranker
- Rich - 终端美化

## License

MIT License
